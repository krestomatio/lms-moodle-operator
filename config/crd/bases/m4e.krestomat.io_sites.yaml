---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.8.0
  creationTimestamp: null
  name: sites.m4e.krestomat.io
spec:
  group: m4e.krestomat.io
  names:
    kind: Site
    listKind: SiteList
    plural: sites
    singular: site
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - description: Age of the resource
      jsonPath: .metadata.creationTimestamp
      name: AGE
      type: date
    - description: Site status such as Unknown/SettingUp/Ready/Failed/Terminating
        etc
      jsonPath: .status.state
      name: STATUS
      type: string
    - description: Time of latest transition
      jsonPath: .status.conditions[?(@.type=='Ready')].lastTransitionTime
      name: SINCE
      type: date
    - description: Flavor name
      jsonPath: .spec.flavor
      name: FLAVOR
      type: string
    - description: Site URL
      jsonPath: .spec.moodleSpec.moodleHost
      name: HOST
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        properties:
          apiVersion:
            type: string
          kind:
            type: string
          metadata:
            type: object
          spec:
            properties:
              flavor:
                maxLength: 255
                minLength: 1
                type: string
              keydbSpec:
                properties:
                  keydbAffinity:
                    type: string
                  keydbExtraConfig:
                    type: string
                  keydbImage:
                    maxLength: 255
                    type: string
                  keydbMode:
                    enum:
                    - standalone
                    - multimaster
                    - custom
                    type: string
                  keydbNodeSelector:
                    type: string
                  keydbPvcDataSize:
                    maxLength: 20
                    minLength: 2
                    type: string
                  keydbPvcDataStorageAccessMode:
                    enum:
                    - ReadWriteOnce
                    - ReadOnlyMany
                    - ReadWriteMany
                    type: string
                  keydbPvcDataStorageClassName:
                    maxLength: 63
                    minLength: 2
                    type: string
                  keydbResourceLimits:
                    type: boolean
                  keydbResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  keydbResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  keydbResourceRequests:
                    type: boolean
                  keydbResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  keydbResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  keydbSize:
                    format: int32
                    type: integer
                  keydbTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                type: object
              moodleSpec:
                properties:
                  moodleConfigAdditionalBlock:
                    type: string
                  moodleConfigAdditionalCfg:
                    type: object
                  moodleConfigSessionRedisCompressor:
                    enum:
                    - none
                    - gzip
                    - zstd
                    type: string
                  moodleConfigSessionRedisPrefix:
                    maxLength: 100
                    type: string
                  moodleConfigSessionRedisSerializerUseIgbinary:
                    type: boolean
                  moodleCronjobAffinity:
                    type: string
                  moodleCronjobNodeSelector:
                    type: string
                  moodleCronjobResourceLimits:
                    type: boolean
                  moodleCronjobResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  moodleCronjobResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  moodleCronjobResourceRequests:
                    type: boolean
                  moodleCronjobResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  moodleCronjobResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  moodleCronjobTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  moodleHealthcheckSubpath:
                    maxLength: 100
                    minLength: 2
                    type: string
                  moodleHost:
                    maxLength: 100
                    minLength: 2
                    type: string
                  moodleImage:
                    maxLength: 255
                    type: string
                  moodleKeydbMetaName:
                    maxLength: 63
                    type: string
                  moodleNewAdminpassHash:
                    maxLength: 60
                    minLength: 60
                    pattern: ^\$2[ayb]\$.{56}$
                    type: string
                  moodleNewInstance:
                    type: boolean
                  moodleNewInstanceAdminmail:
                    maxLength: 100
                    minLength: 3
                    type: string
                  moodleNewInstanceAdminuser:
                    maxLength: 100
                    minLength: 1
                    type: string
                  moodleNewInstanceAgreeLicense:
                    type: boolean
                  moodleNewInstanceFullname:
                    maxLength: 100
                    type: string
                  moodleNewInstanceJobAffinity:
                    type: string
                  moodleNewInstanceJobNodeSelector:
                    type: string
                  moodleNewInstanceJobResourceLimits:
                    type: boolean
                  moodleNewInstanceJobResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  moodleNewInstanceJobResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  moodleNewInstanceJobResourceRequests:
                    type: boolean
                  moodleNewInstanceJobResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  moodleNewInstanceJobResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  moodleNewInstanceJobTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  moodleNewInstanceLang:
                    maxLength: 15
                    minLength: 2
                    pattern: ^[a-z_]+$
                    type: string
                  moodleNewInstanceShortname:
                    maxLength: 100
                    type: string
                  moodleNewInstanceSummary:
                    maxLength: 300
                    type: string
                  moodleNfsMetaName:
                    maxLength: 63
                    type: string
                  moodlePort:
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  moodlePostgresMetaName:
                    maxLength: 63
                    type: string
                  moodleProtocol:
                    enum:
                    - http
                    - https
                    type: string
                  moodlePvcDataSize:
                    maxLength: 100
                    minLength: 2
                    type: string
                  moodlePvcDataStorageAccessMode:
                    enum:
                    - ReadWriteOnce
                    - ReadOnlyMany
                    - ReadWriteMany
                    type: string
                  moodlePvcDataStorageClassName:
                    maxLength: 63
                    minLength: 2
                    type: string
                  moodleRedisHost:
                    maxLength: 100
                    type: string
                  moodleRedisMucStore:
                    type: boolean
                  moodleRedisMucStoreCompressor:
                    maximum: 1
                    minimum: 0
                    type: integer
                  moodleRedisMucStorePrefix:
                    maxLength: 100
                    type: string
                  moodleRedisMucStoreSerializer:
                    maximum: 2
                    minimum: 1
                    type: integer
                  moodleRedisSecret:
                    maxLength: 255
                    type: string
                  moodleRedisSecretAuthKey:
                    maxLength: 100
                    type: string
                  moodleRedisSessionStore:
                    type: boolean
                  moodleSubpath:
                    maxLength: 100
                    minLength: 2
                    type: string
                  moodleUpdateJobAffinity:
                    type: string
                  moodleUpdateJobNodeSelector:
                    type: string
                  moodleUpdateJobResourceLimits:
                    type: boolean
                  moodleUpdateJobResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  moodleUpdateJobResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  moodleUpdateJobResourceRequests:
                    type: boolean
                  moodleUpdateJobResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  moodleUpdateJobResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  moodleUpdateJobTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  moodleUpdateMajor:
                    type: boolean
                  moodleUpdateMinor:
                    type: boolean
                  nginxAffinity:
                    type: string
                  nginxExtraConfig:
                    type: string
                  nginxImage:
                    maxLength: 255
                    type: string
                  nginxIngressAnnotations:
                    type: string
                  nginxNodeSelector:
                    type: string
                  nginxResourceLimits:
                    type: boolean
                  nginxResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  nginxResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  nginxResourceRequests:
                    type: boolean
                  nginxResourceRequestsCpu:
                    type: string
                  nginxResourceRequestsMemory:
                    type: string
                  nginxSize:
                    format: int32
                    maximum: 255
                    minimum: 0
                    type: integer
                  nginxTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  phpFpmAffinity:
                    type: string
                  phpFpmExtraConfig:
                    type: string
                  phpFpmImage:
                    maxLength: 255
                    type: string
                  phpFpmIngressAnnotations:
                    type: string
                  phpFpmNodeSelector:
                    type: string
                  phpFpmPhpExtraIni:
                    type: string
                  phpFpmResourceLimits:
                    type: boolean
                  phpFpmResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  phpFpmResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  phpFpmResourceRequests:
                    type: boolean
                  phpFpmResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  phpFpmResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  phpFpmSize:
                    format: int32
                    maximum: 255
                    minimum: 0
                    type: integer
                  phpFpmTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  routineStatusCrNotify:
                    properties:
                      headers:
                        type: object
                      jwtSecretEnvName:
                        type: string
                      method:
                        enum:
                        - GET
                        - POST
                        - PUT
                        - PATCH
                        - DELETE
                        type: string
                      statusCode:
                        items:
                          type: integer
                        type: array
                      url:
                        type: string
                      uuid:
                        maxLength: 36
                        minLength: 36
                        type: string
                    required:
                    - url
                    type: object
                  routineStatusCrNotifyTermination:
                    properties:
                      headers:
                        type: object
                      jwtSecretEnvName:
                        type: string
                      method:
                        enum:
                        - GET
                        - POST
                        - PUT
                        - PATCH
                        - DELETE
                        type: string
                      statusCode:
                        items:
                          type: integer
                        type: array
                      url:
                        type: string
                      uuid:
                        maxLength: 36
                        minLength: 36
                        type: string
                    required:
                    - url
                    type: object
                required:
                - moodleNewAdminpassHash
                - moodleNewInstanceAdminmail
                - moodleNewInstanceAgreeLicense
                type: object
              nfsSpec:
                properties:
                  ganeshaAffinity:
                    type: string
                  ganeshaConfLogLevel:
                    enum:
                    - "NULL"
                    - FATAL
                    - MAJ
                    - CRIT
                    - WARN
                    - EVENT
                    - INFO
                    - DEBUG
                    - MID_DEBUG
                    - M_DBG
                    - FULL_DEBUG
                    - F_DBG
                    type: string
                  ganeshaExportGroupid:
                    format: int32
                    type: integer
                  ganeshaExportMode:
                    pattern: '[0-7]{4}'
                    type: string
                  ganeshaExportUserid:
                    format: int32
                    type: integer
                  ganeshaExtraBlockConfig:
                    type: string
                  ganeshaImage:
                    maxLength: 255
                    type: string
                  ganeshaNodeSelector:
                    type: string
                  ganeshaPvcDataAutoexpansion:
                    type: boolean
                  ganeshaPvcDataAutoexpansionCapGib:
                    format: int32
                    type: integer
                  ganeshaPvcDataAutoexpansionIncrementGib:
                    format: int32
                    type: integer
                  ganeshaPvcDataSize:
                    maxLength: 20
                    minLength: 2
                    type: string
                  ganeshaPvcDataStorageAccessMode:
                    enum:
                    - ReadWriteOnce
                    - ReadOnlyMany
                    - ReadWriteMany
                    type: string
                  ganeshaPvcDataStorageClassName:
                    maxLength: 63
                    minLength: 2
                    type: string
                  ganeshaResourceLimits:
                    type: boolean
                  ganeshaResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  ganeshaResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  ganeshaResourceRequests:
                    type: boolean
                  ganeshaResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  ganeshaResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  ganeshaTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                type: object
              postgresSpec:
                properties:
                  pgbouncerAffinity:
                    type: string
                  pgbouncerExtraConfig:
                    type: string
                  pgbouncerNodeSelector:
                    type: string
                  pgbouncerReadonlyAffinity:
                    type: string
                  pgbouncerReadonlyExtraConfig:
                    type: string
                  pgbouncerReadonlyNodeSelector:
                    type: string
                  pgbouncerReadonlyResourceLimits:
                    type: boolean
                  pgbouncerReadonlyResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  pgbouncerReadonlyResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  pgbouncerReadonlyResourceRequests:
                    type: boolean
                  pgbouncerReadonlyResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  pgbouncerReadonlyResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  pgbouncerReadonlyTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  pgbouncerResourceLimits:
                    type: boolean
                  pgbouncerResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  pgbouncerResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  pgbouncerResourceRequests:
                    type: boolean
                  pgbouncerResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  pgbouncerResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  pgbouncerTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  postgresAffinity:
                    type: string
                  postgresExtraConfig:
                    type: string
                  postgresImage:
                    maxLength: 255
                    type: string
                  postgresMode:
                    enum:
                    - standalone
                    - readreplicas
                    type: string
                  postgresNodeSelector:
                    type: string
                  postgresPvcDataSize:
                    maxLength: 20
                    minLength: 2
                    type: string
                  postgresPvcDataStorageAccessMode:
                    enum:
                    - ReadWriteOnce
                    - ReadOnlyMany
                    - ReadWriteMany
                    type: string
                  postgresPvcDataStorageClassName:
                    maxLength: 63
                    minLength: 2
                    type: string
                  postgresReadreplicasAffinity:
                    type: string
                  postgresReadreplicasNodeSelector:
                    type: string
                  postgresReadreplicasPvcDataSize:
                    maxLength: 20
                    minLength: 2
                    type: string
                  postgresReadreplicasPvcDataStorageAccessMode:
                    enum:
                    - ReadWriteOnce
                    - ReadOnlyMany
                    - ReadWriteMany
                    type: string
                  postgresReadreplicasPvcDataStorageClassName:
                    maxLength: 63
                    minLength: 2
                    type: string
                  postgresReadreplicasResourceLimits:
                    type: boolean
                  postgresReadreplicasResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  postgresReadreplicasResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  postgresReadreplicasResourceRequests:
                    type: boolean
                  postgresReadreplicasResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  postgresReadreplicasResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  postgresReadreplicasSize:
                    format: int32
                    type: integer
                  postgresReadreplicasTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                  postgresResourceLimits:
                    type: boolean
                  postgresResourceLimitsCpu:
                    maxLength: 20
                    type: string
                  postgresResourceLimitsMemory:
                    maxLength: 20
                    type: string
                  postgresResourceRequests:
                    type: boolean
                  postgresResourceRequestsCpu:
                    maxLength: 20
                    type: string
                  postgresResourceRequestsMemory:
                    maxLength: 20
                    type: string
                  postgresSize:
                    format: int32
                    type: integer
                  postgresTolerations:
                    items:
                      properties:
                        effect:
                          type: string
                        key:
                          type: string
                        operator:
                          type: string
                        tolerationSeconds:
                          format: int64
                          type: integer
                        value:
                          type: string
                      type: object
                    type: array
                type: object
            required:
            - flavor
            - moodleSpec
            type: object
          status:
            properties:
              conditions:
                items:
                  properties:
                    lastTransitionTime:
                      format: date-time
                      type: string
                    message:
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              state:
                default: Unknown
                enum:
                - Unknown
                - Creating
                - SettingUp
                - Failed
                - Ready
                - Terminating
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
